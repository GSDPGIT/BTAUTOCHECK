{% extends "base.html" %}
{% block title %}ç³»ç»Ÿæ—¥å¿— - BTAUTOCHECK{% endblock %}
{% block content %}
<h2 style="margin-bottom: 2rem;">ğŸ“ ç³»ç»Ÿæ—¥å¿—</h2>
<div class="card">
    <div class="card-header">æ—¥å¿—æ–‡ä»¶åˆ—è¡¨</div>
    {% if logs %}
    <table>
        <thead><tr><th>æ–‡ä»¶å</th><th>å¤§å°</th><th>ä¿®æ”¹æ—¶é—´</th><th>æ“ä½œ</th></tr></thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{{ log.filename }}</td>
                <td>{{ (log.size / 1024) | round(2) }} KB</td>
                <td>{{ log.mtime }}</td>
                <td><button onclick="viewLog('{{ log.filename }}')" class="btn btn-primary" style="padding: 0.5rem 1rem;">æŸ¥çœ‹</button></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #868e96; text-align: center; padding: 2rem;">æš‚æ— æ—¥å¿—</p>
    {% endif %}
</div>
<div id="logContent" class="card" style="display: none;">
    <div class="card-header">æ—¥å¿—å†…å®¹</div>
    <div class="log-viewer"><pre id="logText"></pre></div>
</div>
{% endblock %}
{% block extra_js %}
<script>
function viewLog(filename) {
    fetch('{{ url_for("log_view", filename="FILENAME") }}'.replace('FILENAME', filename))
    .then(r => r.json())
    .then(data => {
        if (data.success) {
            document.getElementById('logContent').style.display = 'block';
            document.getElementById('logText').textContent = data.content;
            document.getElementById('logContent').scrollIntoView({behavior: 'smooth'});
        } else {
            alert('âŒ ' + data.message);
        }
    });
}
</script>
{% endblock %}

